<nz-page-header
  class="site-page-header"
>
  <nz-breadcrumb nz-page-header-breadcrumb>
    <nz-breadcrumb-item>Phòng</nz-breadcrumb-item>
    <nz-breadcrumb-item>Quản lý phòng đặt</nz-breadcrumb-item>
  </nz-breadcrumb>
</nz-page-header>

<div class="page-content">
  <div>
    <div class="flex">
      <div style="font-size: 18px;margin-left: 10px;font-family: Arial">
        <label>Ngày trả phòng</label>
        <input type="date" id="checkOut"
               style="width: 200px;height:30px;border-radius: 5px;border: 1px solid lightskyblue;margin-left: 10px;margin-top: 10px;padding: 5px">
      </div>
      <div style="font-size: 18px;margin-left: 30px;font-family: Arial;margin-top: 10px">
        <label>Loại phòng</label>
        <select id="tenLoaiPhong" class="select-input"
                style="width: 200px;height: 30px;font-size: 18px;border-width: 1px; border-style: solid; border-color: dodgerblue;border-radius: 3px;margin-left: 10px"
        >
          <option class="option" value="">Tất cả</option>
          <option class="option" *ngFor="let data of roomType"
                  [label]="data.tenLoaiPhong ? data.tenLoaiPhong : 'Chọn loại phòng'"
                  [value]="data.tenLoaiPhong"></option>
        </select>
      </div>
      <div style="font-size: 18px;margin-left: 30px;font-family: Arial;margin-top: 10px">
        <label>Trạng thái phòng</label>
        <select id="trangThai" class="select-input"
                style="width: 200px;height: 30px;font-size: 18px;border-width: 1px; border-style: solid; border-color: dodgerblue;border-radius: 3px;margin-left: 10px"
        >
          <option class="option" value="0">Tất cả</option>
          <option class="option" value="1">Đã check-in</option>
          <option class="option" value="2">Chờ check-in</option>
        </select>
      </div>
    </div>
    <div class="flex">
      <div style="font-size: 18px;margin-left: 10px;font-family: Arial;margin-top: 10px">
        <label>Khách hàng: </label>
        <input id="khachHang"
               style="width: 400px;height:30px;border-radius: 5px;border: 1px solid lightskyblue;margin-left: 10px;margin-top: 30px;padding: 5px"
               placeholder="Nhập tên hoặc số CCCD khách hàng">
      </div>
      <div style="margin-left: 30px;margin-top: 30px">
        <button (click)="resetSearch()" class="button-danger"
        >
          Đặt lại
        </button>
      </div>
      <div style="margin-left: 30px">
        <button style="margin-top: 30px;" class="relative inline-flex items-center justify-center p-0.5 mb-2 mr-2 overflow-hidden text-sm font-medium
      text-gray-900 rounded-lg group bg-gradient-to-br from-cyan-500 to-blue-500 group-hover:from-cyan-500
      group-hover:to-blue-500 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-cyan-200 dark:focus:ring-cyan-800">
                <span
                  class="relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0">
          Tìm kiếm
                </span>
        </button>
      </div>
    </div>
    <!--    <nz-table class="w-full text-sm text-left text-gray-500 dark:text-gray-400" #tableData [nzData]="room">-->
    <!--      <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">-->
    <!--      <tr>-->
    <!--        <th scope="col" class="px-6 py-3">-->
    <!--          STT-->
    <!--        </th>-->
    <!--        <th scope="col" class="px-6 py-3">-->
    <!--          Mã số phòng-->
    <!--        </th>-->
    <!--        <th scope="col" class="px-6 py-3">-->
    <!--          Ngày đặt-->
    <!--        </th>-->
    <!--        <th scope="col" class="px-6 py-3">-->
    <!--          Ngày check-in-->
    <!--        </th>-->
    <!--        <th scope="col" class="px-6 py-3">-->
    <!--          Ngày check-out-->
    <!--        </th>-->
    <!--      </tr>-->
    <!--      </thead>-->
    <!--    </nz-table>-->
    <hr style="margin: 10px;">
    <div style="margin-top: 10px">
      <div nz-row>
        <div *ngFor="let data of room" nz-col nzSpan="6">
          <div (click)="showDetail(data.id, data.idDatPhong, data.idHoaDon)"
               style="border: 1px solid gray;border-radius: 5px;margin: 10px;height: 250px;background-color: lightskyblue">
            <p
              style="text-align: center;font-family: 'Roboto Mono', monospace;font-size: 22px;font-weight: bold;color: grey;margin: 3px">
              {{data.tenPhong}} | {{data.id}}
            </p>
            <hr style="margin: 5px;color: #5e2ced">
            <div *ngIf="data.id" style="font-size: 15px;padding-left: 5px">
              <div class="flex">
                <div class="flex" style="width: 50%">
                  <span nz-icon nzType="home" nzTheme="outline"></span>
                  <p style="margin-top: -3px;margin-left: 5px"> {{data.tenLoaiPhong}}</p>
                </div>
                <div class="flex" style="margin-left: 10px">
                  <span nz-icon nzType="team" nzTheme="outline"></span>
                  <p style="margin-top: -3px;margin-left: 5px"> 2 người</p>
                </div>
              </div>

              <div class="flex">
                <div class="flex" style="width: 50%">
                  <span nz-icon nzType="user" nzTheme="outline"></span>
                  <p style="margin-top: -3px;margin-left: 5px"> {{data.hoTen}}</p>
                </div>
                <div class="flex" style="margin-left: 10px">
                  <span nz-icon nzType="check" nzTheme="outline"></span>
                  <p style="margin-top: -3px;margin-left: 5px" *ngIf="data.trangThai == 2">Đã
                    check-in</p>
                  <p style="margin-top: -3px;margin-left: 5px" *ngIf="data.trangThai == 1">Chờ
                    check-in</p>
                </div>
              </div>

              <div class="flex" style="margin-top: 20px">
                <span nz-icon nzType="field-time" nzTheme="outline"></span>
                <p style="margin-top: -3px;margin-left: 5px">{{ data.checkIn | date : 'dd-MM-yyyy'}}
                  - {{ data.checkOut | date : 'dd-MM-yyyy'}}</p>
              </div>
            </div>
            <div *ngIf="!data.idDatPhong">
              <p style="font-size: 30px;text-align: center">Sẵn sàng đón khách</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<nz-modal
  [(nzVisible)]="isVisible"
  nzTitle="THÔNG TIN PHÒNG"
  (nzOnCancel)="handleCancel()"
  (nzOnOk)="onOk()"
  nzWidth="full"
  nzFooter=" "
>
  <ng-container *nzModalContent>
    <div>
      <div>
        <p style="text-align: center;font-size: 30px;font-weight:bolder;margin-bottom: 5px">Phòng
          số {{roomModel.tenPhong}}</p>
        <hr>
      </div>
      <br>
      <div *ngIf="roomModel.idDatPhong" class="flex">
        <div style="width: 68%;">
          <div style="height: 400px;border: 1px solid darkgrey;border-radius: 5px;margin: 5px">
            <div style="height: 35px;background-color: deepskyblue">
              <p style="color: white;font-weight: bolder;font-size: 16px;padding: 3px;padding-left: 10px">Chi tiết thuê
                phòng</p>
            </div>
            <div style="padding:10px;padding-top:10px;font-size: 15px;font-weight: bolder" class="flex">
              <p>Khách hàng: </p>
              <p style="color:red;"> {{roomModel.hoTen}}</p>
              <p style="padding-left: 30px">Số phòng: </p>
              <p style="color:red;"> {{roomModel.tenPhong}}</p>
              <p style="padding-left: 30px">Loại phòng: </p>
              <p style="color:red;"> {{roomModel.tenLoaiPhong}}</p>
              <p style="padding-left: 30px">Ngày nhận phòng: </p>
              <p style="color:red;"> {{roomModel.checkIn | date : 'dd-MM-yyyy'}}</p>
              <p style="padding-left: 30px">Ngày trả phòng: </p>
              <p style="color:red;"> {{roomModel.checkOut | date : 'dd-MM-yyyy'}}</p>
              <button style="margin-left: 10px" class="button-blue" *ngIf="roomModel.trangThai == 1">Check-in</button>
            </div>
            <hr>
            <div>
              <h3 style="font-weight: bolder;font-size: 16px;padding: 5px">Danh sách phòng cùng đặt</h3>
              <nz-table #basicTable [nzData]="roomOfBill">
                <thead>
                <tr>
                  <th>STT</th>
                  <th>Số phòng</th>
                  <th>Loại phòng</th>
                  <th>Giá phòng</th>
                  <th>Ngày đặt</th>
                  <th>Ngày nhận phòng</th>
                  <th>Ngày trả phòng</th>
                  <th>Trạng thái</th>
                  <th>Tác vụ</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let data of basicTable.data.slice(0,2);let i = index;">
                  <td>{{ i + 1 }}</td>
                  <td>{{ data.tenPhong }}</td>
                  <td>{{ data.tenLoaiPhong }}</td>
                  <td>{{ data.giaPhong }}</td>
                  <td>{{ data.ngayDat | date : 'dd-mm-yyyy' }}</td>
                  <td>{{ data.checkIn | date : 'dd-mm-yyyy' }}</td>
                  <td>{{ data.checkOut | date : 'dd-mm-yyyy' }}</td>
                  <td>{{ data.trangThai == 1 ? 'Chờ nhận phòng' : data.trangThai == 2 ? 'Đã nhận phòng' : data.trangThai == 3 ? 'Đã trả phòng' : 'Đã hủy'}}</td>
                  <td><span nz-icon nzType="eye" nzTheme="outline" nz-tooltip nzTooltipTitle="Xem" (click)="viewRoom()"></span></td>
                </tr>
                </tbody>
              </nz-table>
            </div>
          </div>
          <div style="height: 500px;border: 1px solid darkgrey;border-radius: 5px;margin: 5px">
            <div style="height: 35px;background-color: deepskyblue">
              <p style="color: white;font-weight: bolder;font-size: 16px;padding: 3px;padding-left: 10px">
                Chi tiết dịch vụ
              </p>
            </div>
            <div class="flex">
              <div style="width: 55%;height:445px;border: 1px solid darkgrey;border-radius: 5px;margin: 5px">
                <h3 style="font-weight: bolder;font-size: 16px;padding: 5px">Danh sách dịch vụ sử dụng</h3>
                <nz-table #basicTable [nzData]="roomOfBill">
                  <thead>
                  <tr>
                    <th>STT</th>
                    <th>Tên dịch vụ</th>
                    <th>Số lượng</th>
                    <th>Thời gian đặt</th>
                    <th>Đơn giá</th>
                    <th>Tổng</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr *ngFor="let data of basicTable.data.slice(0,2);let i = index;">
                    <td>{{ i + 1 }}</td>
                    <td>Dịch vụ {{ i + 1 }}</td>
                    <td>{{ i + 1 }}</td>
                    <td>{{ data.ngayDat | date : 'dd-mm-yyyy hh:mm:ss' }}</td>
                    <td>{{ data.giaPhong}}</td>
                    <td>{{ data.giaPhong * (i + 1)}}</td>
                  </tr>
                  </tbody>
                </nz-table>
              </div>
              <div style="width: 43%;height:445px;border: 1px solid darkgrey;border-radius: 5px;margin: 5px">
                <h3 style="font-weight: bolder;font-size: 16px;padding: 5px">Order dịch vụ</h3>
                <div nz-row>
                  <div *ngFor="let data of roomServiceModel" nz-col nzSpan="8">
                    <div style="border: 1px solid gray;border-radius: 5px;margin: 10px;height: 180px;">
                      <div style="width: 90%;height: 60%;margin: 3px">
                        <img src="./assets/images/ruou-vang.jpg" style="width: 100%;height: 100%">
                      </div>
                      <div style="padding: 5px;font-weight: bolder">
                        <h1>{{data.tenDichVu}}</h1>
                        <h1>Giá: {{data.giaDichVu}}</h1>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div style="width: 30%;height: 905px;border: 1px solid darkgrey;border-radius: 5px;margin: 5px">
          <div style="height: 35px;background-color: deepskyblue">
            <p style="color: white;font-weight: bolder;font-size: 16px;padding: 3px;padding-left: 10px">Thông tin khách
              hàng</p>
          </div>
          <div style="border: 1px solid darkgrey;border-radius: 5px;margin: 5px">
            <div class="flex" style="font-size: 17px;padding: 10px;font-weight: bolder">
              <div style="width: 40%">
                <p>Mã khách hàng: </p>
                <hr>
                <p>Họ và tên: </p>
                <hr>
                <p>Số CCCD: </p>
                <hr>
                <p>Số điện thoại: </p>
                <hr>
                <p>Tổng số phòng đặt: </p>
                <hr>
              </div>
              <div style="width: 60%;color: dodgerblue">
                <p> {{roomModel.maKhachHang}}</p>
                <hr>
                <p> {{roomModel.hoTen}}</p>
                <hr>
                <p> {{roomModel.cccd}}</p>
                <hr>
                <p> {{roomModel.sdt}}</p>
                <hr>
                <p> 9999</p>
                <hr>
              </div>
            </div>
          </div>
          <div style="border: 1px solid darkgrey;border-radius: 5px;margin: 5px">
            <p style="text-align: center;font-weight: bolder;background-color: deepskyblue">Thông tin thanh toán</p>
          </div>
          <div style="border: 1px solid darkgrey;border-radius: 5px;margin: 5px;font-size: 17px;font-weight: bolder;padding: 10px">
            <p>Mã hóa đơn: {{roomModel.maHD}}</p>
            <hr style="margin: 10px">
            <p>Ngày tạo: {{roomModel.ngayTao | date : 'dd-MM-yyyy hh:mm:ss'}}</p>
            <hr style="margin: 10px">
            <p>Khách hàng: {{roomModel.maKhachHang}}</p>
            <hr style="margin: 10px">
            <p>Tổng tiền: {{roomModel.tongTien}}</p>
            <hr style="margin: 10px">
            <p>Trạng thái thanh toán: {{roomModel.trangThaiThanhToan == 0 ? 'Đã thanh toán' : roomModel.trangThaiThanhToan == (1||3) ? 'Thanh toán sau' : roomModel.trangThaiThanhToan == 4 ? 'Đang xác nhận' : 'Đã hủy'}}</p>
            <hr style="margin: 10px">
            <p>Ngày thanh toán: {{roomModel.ngayThanhToan | date : 'dd-MM-yyyy hh:mm:ss'}}</p>
            <hr style="margin: 10px">
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</nz-modal>

